---
title: "p8105_hw5_xt2288"
author: "Xiaoting Tang"
date: "`r Sys.Date()`"
output: github_document
---

```{r}
library(tidyverse)
```

# Problem 1


# Problem 2

```{r message=FALSE}
long_study = 
  data.frame(file_name = list.files("data/problem2data", full.names = TRUE)) |>
  mutate(obs = purrr::map(file_name, read_csv)) |>
  mutate(arm = list.files("data/problem2data"),
         subject_id = list.files("data/problem2data")) |>
  mutate(subject_id = gsub("\\D", "",  subject_id),
         arm = substr(arm, 1, 3),
         arm = 
           case_match(
             arm,
             "con" ~ "control",
             "exp" ~ "experimental"
           )) |>
  unnest(cols = c(obs)) |>
  relocate(arm, subject_id, everything()) |>
  select(-file_name) |>
  pivot_longer(
    week_1:week_8,
    names_to = "week", 
    values_to = "data"
  )

long_study |>
  ggplot(aes(x = week, y = data, group = subject_id, color = subject_id)) + 
  geom_smooth(se = FALSE) +
  facet_grid(~arm)
```








